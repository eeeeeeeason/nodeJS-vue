# 内容回顾


# Express
	方便，快速的开发
	
	iOS AFN 
	Android Volley
	前端 jQuery
		Angular $http
		Vue    Vue-Resource $http
		fetch 用来替代XMLHTTPRequest
		
## Express

	1、获取GET/POST请求
		GET  req.query.username
		POST body-parser https://www.npmjs.com/package/body-parser
		
	2、能够分门别类的处理我们请求
		2.1、建立一个单独的js文件，写路由相关的代码
		2.2、在入口文件中使用，实现分流
	
	3、静态资源的处理
		3.1、先在入口文件的路由代码前面写好设置我们静态资源的根路径
			app.use(express.static(路径))
			
		3.2、在页面中发送请求的时候，路径写法是:除开了根路径之后的具体路径
		
	4、权限管理

------------------------------------------

## mongodb

	服务端:
		存数我们用户产生的具体数据
		
		1、安装
		2、配置环境变量，目的是为了在cmd中方便的使用
		3、使用它安装目录下面的mongod可执行文件来启动我们mongodb服务端【前提】
		
	启动方式
		1、直接在cmd中输入 mongod --dbpath c:/mongodb_datas
		2、做成批处理
		3、做成开机启动
		
### 数据库客户端(robomongo)想操作mongodb服务端
	步骤:
		1、连接到我们mongodb服务端，连接成功之后，会得到一个db对象
		
		2、拿着上面得到的db对象，来操作mongodb服务端的数据【增、删、改、查】
		
### 几个概念
	数据库
		> 集合(相同的数据放入到特定的集合，比如学生信息放入学生集合，商品数据放入商品集合)
	
			> 文档（一条一条的数据）

### 在NodeJS中使用mongodb这个第三方包来操作我们mongodb数据库中的数据
	参考：
		https://www.npmjs.com/package/mongodb
		
	前提准备:
		1、使用`npm i mongodb --save`来安装
		
	正式集成:
		1、导入包
		2、拿到我们mongoClient对象
		3、使用mongoClient连接到mongodb的服务端，返回操作数据库的db对象
		4、通过db对象，拿到foodInfo这个集合
			```
				db.collection('foodInfo')
			```
		5、就调用集合的增，删，改，查的方法，来操作数据库中的数据
			

------------------------------------------

# 项目

### 涉及到的知识点
	1、Express的使用
	2、对数据库的操作(MongoDB)
	3、验证码，短信验证码(语音验证码)
	4、session、cookies(前后台数据存储的方式)
	5、Express next方法&all方法(权限验证的技术组成之一)
	6、gulp

------------------------------------------

# 项目的开发阶段分析

### 需求调研阶段
	做什么事?
		外包：客户的，一定要和客户把需求搞明白，邮件沟通
		自家产品：
			根据需求，描述我们的产品以后究竟做成什么样子
			mobile xiaohuangche
			
	哪些人参与?
		产品经理 PM
		张小龙
			QQ:即时通讯
			
			微信: 朋友圈（封闭） 摇一摇 轻量级
		
	出哪些成果
		需求文档，一般是word文档

### 原型设计阶段
	做什么事?
		将上一步通过文字描述的需求，图片化
		
	哪些人参与
		产品经理，UI设计师
		
	出哪些成果
		原型图，交互图，给开发人员看
		标注图：标注我们每个网页上面有哪些元素，每个元素多宽，多高(PS)
		切图：你在App中用到的图标(PS)

### 编码阶段【必须】
	前台:
		前端、iOS、Android 根据原型图画UI
		
		发送网络请求给后台，后台返回数据给前台
		
	后台:
		java,php,.net,xxx
		
	API文档
		后台人员开发完毕一个接口，就会写一个文档给我们
		
	出的成果
		代码

### 测试阶段
	提bug
	

### 上线阶段【必须】
	代码压缩，优化
	
	技术经理 ftp工具
	
	运维人员

### 公司的开发人员的大致配置

	小团队
	
	java
		30个
		
		用友
			5个
			
		医院
			100
	
	创业公司
		iOS 2个
		Android 2个
		前端 5个 2 webapp 2个微信，公众平台  php
		后台 4个
		测试2个妹子
		UI 2个
		
	光线
		前端
			5个 管理系统 宣传 先看
		
		新媒体:70人
		
### 第一天
	
	保密协议...
		100万
		
	担保协议...
	
	
	2周
		
------------------------------------------

## 项目搭建

### 项目需要使用的技术栈
	Express : 开启Web服务

### 创建项目的文件夹及相关文件
	根目录
		src:存放源代码
			app.js 项目的入口文件，开启Web服务
		
			routers : 放我们项目中用到的路由文件，accountRouter(登录、注册) studentManagerRouter(学生管理相关)
			
			views : 存放我们学生管理系统的页面
			
			statics : 存放我们项目的静态资源路径
			
			controllers : 和我们路由对应的，用来处理某个路由下的具体业务逻辑，比如我们可以创建一个accountController来处理和账号相关的具体业务逻辑
			
		package.json:用来描述我们项目，描述我们项目叫什么用到了哪些第三方包
		
### 业务分层
	用户在浏览器的地址栏中输入 http://127.0.0.1:3000/account/login
	
	当来到了服务器中的时候
	
	app.js ---> accountRouter.js---> accountControll.js(getLoginPage函数),传递req,res

------------------------------------------

# 中间件思想
	我们Express是一个平台(机器)，集成很多个中间部件
	
	中间件是在某个平台上面工作的

------------------------------------------

# 验证码
	为什么要有验证码
		防止机器人程序攻击
		
	加一道安全保障，如果验证码不正确，我们后台就不会去数据库中进行校验，减少对数据库的无用操作

## 验证码的生成
	1、是由服务器生成的
	2、服务器生成验证码之后，做两件事
		2.1、在服务器端记录我刚刚生成好的验证码的数字
		2.2、把我们这个验证码数字整成一张图片，返回给浏览器让用户看到

## 登陆时候的验证
	1、浏览器发送请求(post请求)，除了带上用户名和密码还有验证码
	
	2、先判断验证码正确之后，再去数据库中做真正的校验
		2.1 后台先获取浏览器提交过来的验证码(比如1122)
		
		2.2 再去取我当初生成验证码给前台时候，我存起来的验证码数字
		
		2.3 两者进行对比，如果一致，代表验证码正确，继续后面的数据库校验，如果不正确，就将错误的结果，返回给浏览器，让用户看到
		
## 实现上述功能需要用到的技术方案
	1、如何在服务器端存储数据  xxx
	3、如何从服务器端取我们原先存储起来的数据
	
	2、如何在服务器端生成一张带有数字的图片给浏览器 (captchapng)
	
## 后台生成验证码，返回给浏览器去呈现
	1、浏览器发送请求 http://127.0.0.1:3000/account/vcode
	
	2、后台接收到我们的请求之后
		随机生成一个数字【存起来后续在做】
		根据数据生成图片
		通过res.end()返回给浏览器，并且告诉浏览器给你返回的是图片
		
	前提:
		1、安装第三方包
			npm i captchapng --save
			
	代码步骤:
		1、在login.html发送请求
			http://127.0.0.1:3000/account/vcode

		2、后台处理
------------------------------------------

## 实现验证码验证的技术方案
	后台： 要有一种技术，能给每个浏览器分配一块专属的内存空间 session(java,php,node)，并且把专属内存空间的标识符返回给浏览器，告诉他保存起来
	
	前端：得把后台分配给我们的专属的内存空间的标识符(相当于纸条，存储起来)，存取起来的目的，是方便我登录的时候，带着这个标识符去后台，找到我的那块专属内存空间，去里面取值
	
	注意点：
		1、服务器端告诉浏览器要把服务器端生成的内存空间的标识符存储在浏览器端的cookie中，只需要通过响应头告诉浏览器即可，这个时候，浏览器就会乖乖的把服务器给他的标识符存储起来 （响应头）
		
		2、当进行登录的时候，除了提交我们用户名&密码&验证码之外，这个标识符是通过请求头传递给服务器的
		
	接下来做的事情
		服务器如何生成专属于某个浏览器的内存空间，以及通过响应头告诉浏览器如何去把标识符存储到浏览器的cookie中   express-session
		
		express-session 
			1、服务器如何生成专属于某个浏览器的内存空间
			2、响应头告诉浏览器如何去把标识符存储到浏览器的cookie中
			
		进行验证码验证
			1、把生成的验证码存储到我们上一步分配的内存空间中
				
## post获取参数
	npm i body-parser --save
			
## express-session如何使用
	参考:
	
	1、安装 
		npm i express-session --save
		
	2、它是express的中间件，所以使用的时候，使用app.use即可
	
	3、在我们项目的入口文件中配置即可
		
		
	参数的说明:
		http://blog.csdn.net/liangklfang/article/details/50998959
			
## cookie
	参考:http://www.jb51.net/article/64330.htm

	相当于localStorage
	
	document.cookie
	
	可以通过哪些方式保存
		1、自己在浏览器端自己存取,自己触发了js函数，把我们页面上的数据保存到浏览器的cookie中去
		
		2、服务器告诉他，你要存储
			服务器通过响应头的方式，告诉浏览器，要把我给你返回的数据，存储到你的cookie中
	
	应用场景:
		记住用户明和密码
		
	和localStorage不太一样的地方，他有有效期

# 
	曹启文 2115
	
	徐忠菲 4323
	
	罗佩文 9330
	

